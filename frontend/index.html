<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<link href="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/5.2.3/css/bootstrap.min.css" rel="stylesheet"></link>
	<script src="https://cdn.bootcdn.net/ajax/libs/vue/3.2.47/vue.global.min.js"></script>
	<script src="https://cdn.bootcdn.net/ajax/libs/axios/1.3.6/axios.min.js"></script>
	<title>Convert PPTX to sealed PDF</title>
</head>

<body>
	<div id='sealpdfapp'>
		<div class='container'>
			<div class='row'>
				<div class='col-sm-12 col-md-8'>
					<h2>SealPPTX</h2>
					<div class='input-group'>
						<input type='file' class='form-control' v-on:change='uploadpptx'>
						<span class='input-group-text'>{{uploadText}}</span>
					</div>
					<div class='input-group'>
						<span class='input-group-text'>{{tokenText}}</span>
						<input type='text' class='form-control' v-model="pptToken" placeholder="请在此粘入上次生成的 token">
					</div>
					<div class='input-group'>
						<span class='input-group-text'>水印字符串</span>
						<input type='text' class='form-control' v-model="sealText">
					</div>
					<div class='input-group'>
						<button class='btn btn-success' v-on:click='genpdf'>生成</button>
					</div>
					<div>
						<p v-for='o in output'>
							<span v-if='o.text !== undefined'>{{o.text}}</span>
							<span v-if='o.link !== undefined'><a v-bind:href="o.link">点击下载</a></span>
						</p>
					</div>
				</div>
				<div class='col-sm-12 col-md-4'>
					<h3>如何使用</h3>
					<ul>
						<li>上传 pptx 文件, 等待上传完成生成 token</li>
						<li>若需使用之前上传过的文件, 可自行保存并在下次使用时直接输入</li>
						<li>输入水印文字, 点击生成, 等待输出</li>
					</ul>
					<h3>隐私</h3>
					<p>后端部署在 laekov 的私人机器上. laekov 可以看到文件内容.</p>
					<h3>开源</h3>
					<a href='https://github.com/laekov/sealpdf'>GitHub</a>
				</div>
			</div>
		</div>
	</div>
	<script src="./sealclient.js"></script>
</body>
</html>
